# –ú–∏–≥—Ä–∞—Ü–∏—è Supabase –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –¥—Ä—É–∑–µ–π

## –ü—Ä–æ–±–ª–µ–º–∞
–ù–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ –Ω–∞–≤—ã–∫–æ–≤ –¥—Ä—É–∑–µ–π –∏ –∏—Ö —Ç–µ–∫—É—â–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å.

## –ü—Ä–∏—á–∏–Ω–∞
–í —Ç–∞–±–ª–∏—Ü–µ `profiles` –≤ Supabase –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –∫–æ–ª–æ–Ω–∫–∏ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —ç–∫–∏–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–Ω–∞—á–∫–æ–≤ (`equipped_badges`) –∏ —Ä–∞–º–æ–∫ –ø—Ä–æ—Ñ–∏–ª—è (`equipped_frame`).

## –†–µ—à–µ–Ω–∏–µ

### 1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é –≤ Supabase

–û—Ç–∫—Ä–æ–π—Ç–µ SQL Editor –≤ –≤–∞—à–µ–º –ø—Ä–æ–µ–∫—Ç–µ Supabase (https://supabase.com/dashboard) –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é:

```sql
-- –§–∞–π–ª: supabase/migration_add_cosmetics.sql
-- Add cosmetics fields to profiles so friends can see each other's equipped badges and frames

-- Add equipped_badges (array of badge IDs)
ALTER TABLE public.profiles ADD COLUMN IF NOT EXISTS equipped_badges TEXT[];

-- Add equipped_frame (single frame ID)
ALTER TABLE public.profiles ADD COLUMN IF NOT EXISTS equipped_frame TEXT;

-- Add comments for documentation
COMMENT ON COLUMN public.profiles.equipped_badges IS 'Array of equipped badge IDs (cosmetics unlocked via achievements)';
COMMENT ON COLUMN public.profiles.equipped_frame IS 'Currently equipped profile frame ID (cosmetic unlocked via achievements)';
```

### 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥—Ä—É–≥–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã –≤—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –∏–∑ –ø–∞–ø–∫–∏ `supabase/`:

- ‚úÖ `schema.sql` ‚Äî –±–∞–∑–æ–≤–∞—è —Å—Ö–µ–º–∞
- ‚úÖ `migration_skills.sql` ‚Äî —Ç–∞–±–ª–∏—Ü–∞ –Ω–∞–≤—ã–∫–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ `migration_add_persona.sql` ‚Äî –∫–æ–ª–æ–Ω–∫–∞ –¥–ª—è –ø–µ—Ä—Å–æ–Ω—ã (Developer, Gamer, –∏ —Ç.–¥.)
- ‚úÖ `migration_add_email.sql` ‚Äî –∫–æ–ª–æ–Ω–∫–∞ –¥–ª—è email (–µ—Å–ª–∏ –µ—Å—Ç—å)
- üÜï `migration_add_cosmetics.sql` ‚Äî –∫–æ–ª–æ–Ω–∫–∏ –¥–ª—è –∫–æ—Å–º–µ—Ç–∏–∫–∏ (–Ω–æ–≤–∞—è –º–∏–≥—Ä–∞—Ü–∏—è)

### 3. –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ –∫–æ–¥–µ

- **`src/renderer/hooks/useFriends.ts`**: –¢–µ–ø–µ—Ä—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ —á–∏—Ç–∞–µ—Ç –ø–æ–ª—è `equipped_badges` –∏ `equipped_frame` –∏–∑ –ø—Ä–æ—Ñ–∏–ª–µ–π –¥—Ä—É–∑–µ–π
- **`src/renderer/hooks/useProfileSync.ts`**: –£–∂–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç —ç—Ç–∏ –ø–æ–ª—è (—Å—Ç—Ä–æ–∫–∏ 48-54), –Ω–æ —Ä–∞–Ω—å—à–µ –æ–Ω–∏ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–ª–∏—Å—å –∏–∑-–∑–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –∫–æ–ª–æ–Ω–æ–∫

### 4. –ü–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –ù–∞—á–Ω–µ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å —ç–∫–∏–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–∫–∏ –∏ —Ä–∞–º–∫–∏ –≤ Supabase –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
- –î—Ä—É–∑—å—è —Å–º–æ–≥—É—Ç –≤–∏–¥–µ—Ç—å –≤–∞—à–∏ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ –Ω–∞–≤—ã–∫–æ–≤, —Ç–µ–∫—É—â—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å, –ø–µ—Ä—Å–æ–Ω—É, –∑–Ω–∞—á–∫–∏ –∏ —Ä–∞–º–∫–∏
- –í—ã —Å–º–æ–∂–µ—Ç–µ –≤–∏–¥–µ—Ç—å –∏—Ö –¥–∞–Ω–Ω—ã–µ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –Ω–∞–≤—ã–∫–æ–≤

1. **–õ–æ–∫–∞–ª—å–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (SQLite)**: –•—Ä–∞–Ω–∏—Ç –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –Ω–∞–≤—ã–∫–∞—Ö, XP, —Å–µ—Å—Å–∏—è—Ö
2. **Supabase (`user_skills`)**: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–π –±–∞–∑—ã —á–µ—Ä–µ–∑ `supabaseSync.ts`
3. **Supabase (`profiles`)**: –•—Ä–∞–Ω–∏—Ç –æ–±—â–∏–π —É—Ä–æ–≤–µ–Ω—å (`level` = —Å—É–º–º–∞ –≤—Å–µ—Ö —É—Ä–æ–≤–Ω–µ–π –Ω–∞–≤—ã–∫–æ–≤), —Å—Ç—Ä–∏–∫, –ø–µ—Ä—Å–æ–Ω—É, –∫–æ—Å–º–µ—Ç–∏–∫—É

### –†–µ–∞–ª-—Ç–∞–π–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç:
- **Polling –∫–∞–∂–¥—ã–µ 15 —Å–µ–∫—É–Ω–¥**: –û–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç—É—Å –¥—Ä—É–∑–µ–π (–æ–Ω–ª–∞–π–Ω/–æ—Ñ—Ñ–ª–∞–π–Ω, –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å)
- **Supabase Realtime**: –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö `profiles`, `friendships`, `messages`
- **Profile Sync –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É**: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç –≤–∞—à –ø—Ä–æ—Ñ–∏–ª—å –≤ Supabase
